<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nox</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* NastavenÃ­ fontu Inter pro celou strÃ¡nku, aby to vypadalo modernÄ› a ÄitelnÄ› */
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Styly pro modÃ¡lnÃ­ okna */
        .modal {
            background: #111;
            border: 2px solid #facc15;
            padding: 2rem;
            border-radius: 10px;
            color: #fff;
            max-width: 90%;
            max-height: 90%;
            overflow-y: auto;
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 1000;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        .modal h3 {
            color: #facc15;
            margin-top: 0;
            text-align: center;
        }
        .modal button {
            margin-top: 1rem;
            width: auto;
            display: inline-block;
        }
        .modal-text {
            color: #ccc;
            margin-bottom: 1rem;
        }
        .modal-buttons {
            text-align: right;
            width: 100%;
        }
        .sickness-text {
            color: #F87171;
            font-weight: bold;
        }
        .poison-text {
            color: #A348A3;
            font-weight: bold;
        }
        .task-container {
            background-color: #facc15;
            padding: 1rem;
            border-radius: 0.75rem;
            margin-top: 1rem;
            color: #000;
        }
        .job-item {
            background-color: #f0f0f0;
            padding: 1rem;
            border-radius: 0.75rem;
            margin-bottom: 0.5rem;
        }
        .job-item h4 {
            font-weight: bold;
            color: #111;
            font-size: 1.1rem;
        }
        .job-item p {
            color: #444;
        }
        /* NavÃ­c styl pro tlaÄÃ­tko ZpÄ›t na Dashboard */
        .back-to-dashboard-link {
            display: block;
            width: fit-content;
            background-color: #4a4a4a;
            color: #fff;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            text-decoration: none;
            font-weight: bold;
            margin-bottom: 1.5rem;
            transition: background-color 0.2s ease;
            position: absolute;
            top: 1rem;
            left: 1rem;
            z-index: 100;
        }
        .back-to-dashboard-link:hover {
            background-color: #6a6a6a;
        }
        .back-to-dashboard-link:focus {
            outline: 2px solid #facc15;
            outline-offset: 2px;
        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.min.js"></script>
</head>
<body class="bg-gradient-to-br from-gray-900 via-indigo-900 to-black min-h-screen flex items-center justify-center p-4">
    <a href="../index.html" class="back-to-dashboard-link" aria-label="ZpÄ›t na hlavnÃ­ dashboard Palpatius games" role="button">â† ZpÄ›t na Palpatius games</a>

    <div class="bg-white p-8 rounded-3xl shadow-2xl max-w-4xl w-full text-center space-y-6">
        <h1 class="text-4xl font-extrabold text-gray-800 mb-4">Nox</h1>

        <div id="introScreen" class="hidden">
            <p class="text-gray-700 text-base leading-relaxed text-left">
                VracÃ­m se domÅ¯, unavenÃ½ jako pes po dlouhÃ©m dni. UÅ¾ skoro otvÃ­rÃ¡m dveÅ™e od domu, kdyÅ¾ mÄ› nÄ›co donutÃ­ zastavit se. NÄ›co sedÃ­ pÅ™Ã­mo na prahu. MalÃ©, chlupatÃ©, a ÃºplnÄ› absurdnÃ­ stvoÅ™enÃ­.
                PÅ™ikrÄÃ­m se, abych si ho poÅ™Ã¡dnÄ› prohlÃ©dl. MÃ¡ Äernou  srst, kterÃ¡ se v Å¡eru mÃ­sÃ­ s okolÃ­m. MÃ¡ lehce protÃ¡hlÃ½ ÄumÃ¡Äek, a titÄ›rnÃ© rÅ¯Å¾ky na hlavÄ›. VypadÃ¡ jako pes, ale ne tak ÃºplnÄ›. DÃ­vÃ¡ se na mÄ›. TÄ›ma nejstarÅ¡Ã­ma, nejhlubÅ¡Ã­ma oÄima, co jsem kdy vidÄ›l. 
                â€Kdo jsi, maliÄkÃ½?â€œ zeptÃ¡m se Å¡eptem, opatrnÄ› k nÄ›mu vztÃ¡hnu ruku. Pomalu se natÃ¡hnu a pohladÃ­m ho. Jeho srst je neuvÄ›Å™itelnÄ› hladkÃ¡, jako ta nejjemnÄ›jÅ¡Ã­ lÃ¡tka. V tu chvÃ­li mi hlavou probleskne jedno jedinÃ© slovo, jasnÃ© jako zvon: â€Nox.â€œ
                â€TakÅ¾e ty jsi Nox?â€œ zopakuju pÅ™ekvapenÄ›, zatÃ­mco dÃ¡l hladÃ­m to zÃ¡zraÄnÃ© stvoÅ™enÃ­. DÃ­vÃ¡ se na mÄ›, a najednou, jako by mi nÄ›kdo otevÅ™el okno do jinÃ© dimenze, vÃ­m vÅ¡echno. VÃ­m, Å¾e pÅ™iÅ¡el ze svÄ›ta jmÃ©nem Noxor, svÄ›ta, kterÃ½ uÅ¾ neexistuje. VÃ­m, Å¾e je poslednÃ­. VÃ­m, Å¾e pÅ™eÅ¾ivÅ¡Ã­ se rozutekli, ale on, Nox, si mÄ› nÄ›jak naÅ¡el. HledÃ¡ domov, bezpeÄÃ­, lÃ¡sku a pÅ™Ã¡telstvÃ­. A taky vÃ­m, Å¾e mÃ¡ pÅ™Ã­Å¡ernÃ½ hlad.
                Bez vÃ¡hÃ¡nÃ­ ho vezmu do nÃ¡ruÄe. Je lehkÃ½ jako pÃ­rko, ale cÃ­tÃ­m z nÄ›j obrovskou sÃ­lu a smutek. OtevÅ™u dveÅ™e a vstoupÃ­me do mÃ©ho bytu. Od tÃ© chvÃ­le se stÃ¡vÃ¡me neoddÄ›litelnou dvojkou. Nox uÅ¾ nemusÃ­ mluvit slovy. StaÄÃ­ mi pohled do jeho hlubokÃ½ch oÄÃ­, nebo letmÃ½ dotyk, a vÅ¾dycky vÃ­m, co mi chce Å™Ã­ct. A jÃ¡ vÃ­m, Å¾e naÅ¡e dobrodruÅ¾stvÃ­ teprve zaÄÃ­najÃ­.
            </p>
        </div>

        <div id="startScreen" class="space-y-4">
            <p class="text-gray-700 text-base leading-relaxed text-left">
                PÅ™Ã­bÄ›h Noxe zaÄÃ­nÃ¡! PÅ™iprav se na dobrodruÅ¾stvÃ­ se svÃ½m vlastnÃ­m stvoÅ™enÃ­m jmÃ©nem Nox.
            </p>
            <button id="startGameButton" class="mt-6 bg-purple-600 hover:bg-purple-700 text-white font-bold py-3 px-6 rounded-xl shadow-lg transition duration-300 ease-in-out transform hover:scale-105">
                ZaÄÃ­t hrÃ¡t s Noxem!
            </button>
            <button id="showStoryButton" class="mt-6 bg-gray-400 hover:bg-gray-500 text-white font-bold py-2 px-4 rounded-xl shadow-md transition duration-300 ease-in-out transform hover:scale-105">
                PÅ™Ã­bÄ›h
            </button>
        </div>

        <div id="gameStats" class="hidden space-y-4 flex flex-row items-start justify-center gap-8">
            <div class="flex-shrink-0 mt-6">
                <img src="005._nox.png" alt="Nox" class="w-48 h-auto rounded-3xl shadow-2xl border-4 border-indigo-600" />
            </div>

            <div class="flex-1 max-w-xl space-y-4">
                <h2 id="petNameDisplay" class="text-3xl font-bold text-indigo-700" aria-live="polite">Nox</h2>
                <div id="noxStatus" class="mt-2 text-red-500 font-bold hidden" role="status" aria-live="polite"></div>
                
                <div class="grid grid-cols-2 gap-4 mt-4">
                    <div class="flex items-center justify-between bg-gray-100 p-3 rounded-xl shadow-sm">
                        <span class="text-lg font-medium text-gray-700">JmÃ©no:</span>
                        <span id="petName" class="text-xl font-bold text-gray-700">Nox</span>
                    </div>

                    <div class="flex items-center justify-between bg-gray-100 p-3 rounded-xl shadow-sm">
                        <span class="text-lg font-medium text-gray-700">MÄ›na:</span>
                        <span id="currencyDisplay" class="text-xl font-bold text-gray-700">100 KreditÅ¯</span>
                    </div>

                    <div class="flex items-center justify-between bg-gray-100 p-3 rounded-xl shadow-sm">
                        <span class="text-lg font-medium text-gray-700">VÃ¡ha:</span>
                        <span id="weightStat" class="text-xl font-bold text-gray-700">5 kg</span>
                    </div>
                    
                    <div class="flex items-center justify-between bg-gray-100 p-3 rounded-xl shadow-sm">
                        <span class="text-lg font-medium text-gray-700">Hlad:</span>
                        <span id="hungerStat" class="text-xl font-bold text-red-500">100%</span>
                    </div>
                    
                    <div class="flex items-center justify-between bg-gray-100 p-3 rounded-xl shadow-sm">
                        <span class="text-lg font-medium text-gray-700">Energie:</span>
                        <span id="energyStat" class="text-xl font-bold text-green-500">100%</span>
                    </div>
                    
                    <div class="flex items-center justify-between bg-gray-100 p-3 rounded-xl shadow-sm">
                        <span class="text-lg font-medium text-gray-700">Hygiena:</span>
                        <span id="hygieneStat" class="text-xl font-bold text-blue-500">100%</span>
                    </div>
                    
                    <div class="flex items-center justify-between bg-gray-100 p-3 rounded-xl shadow-sm">
                        <span class="text-lg font-medium text-gray-700">ZÃ¡bava:</span>
                        <span id="funStat" class="text-xl font-bold text-yellow-500">100%</span>
                    </div>
                    
                    <div class="flex items-center justify-between bg-gray-100 p-3 rounded-xl shadow-sm">
                        <span class="text-lg font-medium text-gray-700">Spokojenost:</span>
                        <span id="satisfactionStat" class="text-xl font-bold text-purple-500">100%</span>
                    </div>
                </div>

                <div class="grid grid-cols-2 gap-4 mt-6">
                    <button id="feedButton" class="bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-4 rounded-xl shadow-md transition duration-300 ease-in-out transform hover:scale-105">
                        Nakrmit
                    </button>
                    <button id="batheButton" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-4 rounded-xl shadow-md transition duration-300 ease-in-out transform hover:scale-105">
                        Vykoupat
                    </button>
                    <button id="sleepButton" class="bg-indigo-500 hover:bg-indigo-600 text-white font-bold py-3 px-4 rounded-xl shadow-md transition duration-300 ease-in-out transform hover:scale-105">
                        SpÃ¡t
                    </button>
                    <button id="playButton" class="bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-3 px-4 rounded-xl shadow-md transition duration-300 ease-in-out transform hover:scale-105">
                        HrÃ¡t si
                    </button>
                    <button id="talkButton" class="bg-purple-500 hover:bg-purple-600 text-white font-bold py-3 px-4 rounded-xl shadow-md transition duration-300 ease-in-out transform hover:scale-105">
                        Promluvit si
                    </button>
                    <button id="shopButton" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-3 px-4 rounded-xl shadow-md transition duration-300 ease-in-out transform hover:scale-105">
                        Obchod
                    </button>
                    <button id="firstAidKitButton" class="bg-red-500 hover:bg-red-600 text-white font-bold py-3 px-4 rounded-xl shadow-md transition duration-300 ease-in-out transform hover:scale-105">
                        LÃ©kÃ¡rniÄka
                    </button>
                </div>
                
                <div class="grid grid-cols-2 gap-4 mt-6">
                    <button id="jobManagementButton" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-3 px-4 rounded-xl shadow-md transition duration-300 ease-in-out transform hover:scale-105">
                        SprÃ¡va zamÄ›stnÃ¡nÃ­
                    </button>
                    <button id="jobButton" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-3 px-4 rounded-xl shadow-md transition duration-300 ease-in-out transform hover:scale-105">
                        ZamÄ›stnÃ¡nÃ­
                    </button>
                </div>

                <div class="grid grid-cols-2 gap-4 mt-6">
                    <button id="saveGameButton" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-3 px-4 rounded-xl shadow-md transition duration-300 ease-in-out transform hover:scale-105">
                        Exportovat do JSON
                    </button>
                    <button id="loadGameButton" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-3 px-4 rounded-xl shadow-md transition duration-300 ease-in-out transform hover:scale-105">
                        NahrÃ¡t ze souboru
                    </button>
                </div>
            </div>
        </div>

        <div id="foodMenu" class="hidden mt-6 p-4 bg-gray-50 rounded-xl shadow-inner space-y-3">
            <h3 id="foodMenuTitle" class="text-xl font-semibold text-gray-800 mb-3" tabindex="-1">Vyber jÃ­dlo:</h3>
            <div id="foodOptions" class="grid grid-cols-2 gap-3">
                </div>
            <button id="closeFoodMenuButton" class="mt-4 bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-xl shadow-md transition duration-300 ease-in-out">
                ZpÄ›t
            </button>
        </div>

        <div id="playMenu" class="hidden mt-6 p-4 bg-gray-50 rounded-xl shadow-inner space-y-3">
            <h3 id="playMenuTitle" class="text-xl font-semibold text-gray-800 mb-3" tabindex="-1">Vyber si, co budete dÄ›lat:</h3>
            <div id="playOptions" class="grid grid-cols-2 gap-3">
                </div>
            <button id="closePlayMenuButton" class="mt-4 bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-xl shadow-md transition duration-300 ease-in-out">
                ZpÄ›t
            </button>
        </div>
        
        <div id="shopMenu" class="hidden mt-6 p-4 bg-gray-50 rounded-xl shadow-inner space-y-3">
            <h3 id="shopMenuTitle" class="text-xl font-semibold text-gray-800 mb-3" tabindex="-1">VÃ­tej v obchodÄ›, pÃ¡nÃ­Äku!</h3>
            <p class="text-lg text-gray-700">Tvoje Kredity: <span id="shopCurrencyDisplay" class="font-bold">0</span></p>
            <div id="shopItems" class="grid grid-cols-2 gap-3">
                </div>
            <button id="closeShopMenuButton" class="mt-4 bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-xl shadow-md transition duration-300 ease-in-out">
                ZpÄ›t
            </button>
        </div>
        
        <div id="firstAidKitMenu" class="hidden mt-6 p-4 bg-gray-50 rounded-xl shadow-inner space-y-3">
            <h3 id="firstAidKitMenuTitle" class="text-xl font-semibold text-gray-800 mb-3" tabindex="-1">Tvoje lÃ©kÃ¡rniÄka</h3>
            <div id="firstAidKitItems" class="grid grid-cols-2 gap-3">
                </div>
            <button id="closeFirstAidKitButton" class="mt-4 bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-xl shadow-md transition duration-300 ease-in-out">
                ZpÄ›t
            </button>
        </div>
        
        <div id="tasksMenu" class="hidden mt-6 p-4 bg-gray-50 rounded-xl shadow-inner space-y-3">
            <h3 id="tasksMenuTitle" class="text-xl font-semibold text-gray-800 mb-3" tabindex="-1">Ãškoly</h3>
            <div id="tasksMenuContent" class="text-gray-600">
                </div>
            <div id="taskButtonsContainer" class="flex justify-center space-x-4 mt-4 hidden">
                <button id="acceptTaskButton" class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-xl">PÅ™ijmout</button>
                <button id="declineTaskButton" class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-xl">OdmÃ­tnout</button>
            </div>
            <button id="closeTasksMenuButton" class="mt-4 bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-xl shadow-md transition duration-300 ease-in-out">
                ZpÄ›t
            </button>
        </div>
        
        <div id="jobManagementMenu" class="hidden mt-6 p-4 bg-gray-50 rounded-xl shadow-inner space-y-3">
            <h3 id="jobManagementTitle" class="text-xl font-semibold text-gray-800 mb-3" tabindex="-1">SprÃ¡va zamÄ›stnÃ¡nÃ­</h3>
            <div id="jobManagementContent" class="text-gray-600">
                <p class="mb-2">Zde mÅ¯Å¾eÅ¡ spravovat Noxovo zamÄ›stnÃ¡nÃ­. Vyber prÃ¡ci, kterou bude Nox vykonÃ¡vat.</p>
                <div id="currentJobDisplay" class="bg-gray-200 p-3 rounded-lg text-black mb-4">
                    <p id="currentJobText"></p>
                </div>
                <div id="jobList" class="space-y-2">
                    </div>
            </div>
            <button id="closeJobManagementMenuButton" class="mt-4 bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-xl shadow-md transition duration-300 ease-in-out">
                ZpÄ›t
            </button>
        </div>
        
        <div id="jobMenu" class="hidden mt-6 p-4 bg-gray-50 rounded-xl shadow-inner space-y-3">
            <h3 id="jobMenuTitle" class="text-xl font-semibold text-gray-800 mb-3" tabindex="-1">ZamÄ›stnÃ¡nÃ­</h3>
            <div id="jobContent" class="text-gray-600">
                <p id="jobDescriptionText" class="mb-4">Nox je momentÃ¡lnÄ› nezamÄ›stnanÃ½. Vyber mu prÃ¡ci ve SprÃ¡vÄ› zamÄ›stnÃ¡nÃ­.</p>
                <button id="startJobButton" class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-xl shadow-md transition duration-300 ease-in-out hidden">
                    JÃ­t do prÃ¡ce
                </button>
            </div>
            <button id="closeJobMenuButton" class="mt-4 bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-xl shadow-md transition duration-300 ease-in-out">
                ZpÄ›t
            </button>
        </div>

    </div>

    <div id="customMessageModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="modalMessageTitle" tabindex="-1" aria-live="assertive">
        <div class="modal-content" role="alert">
            <h3 id="modalMessageTitle" class="text-xl font-bold text-yellow-300 mb-4">ZprÃ¡va</h3>
            <p id="modalMessage" class="text-gray-300 mb-4"></p>
            <div class="modal-buttons text-right">
                <button id="modalCancelButton" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-md ml-2 hidden">ZruÅ¡it</button>
                <button id="modalOkButton" class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-md">OK</button>
            </div>
        </div>
    </div>

    <script>
        // === VÃCHOZÃ KONFIGURACE A STAV HRY ===
        
        // Konstanta pro automatickÃ© uklÃ¡dÃ¡nÃ­ (v sekundÃ¡ch)
        const AUTOSAVE_INTERVAL = 60; // kaÅ¾dÃ½ch 60 sekund

        // NaÄtenÃ­ Tone.js syntezÃ¡torÅ¯ pro zvuky
        const simpleSynth = new Tone.Synth().toDestination();
        const polySynth = new Tone.PolySynth(Tone.Synth).toDestination();

        // Konfigurace jÃ­dla
        const foodItems = [
            {
                name: "Granule",
                effects: {
                    hunger: 25, energy: -2, hygiene: 0, fun: -5, satisfaction: -5, weight: 0.1
                },
                taskReward: 5,
                messages: {
                    low: ["Hlad je nejlepÅ¡Ã­ kuchaÅ™. Nox sice granule v lÃ¡sce nemÃ¡, ale pro plnÃ© bÅ™Ã­Å¡ko udÄ›lÃ¡ vÅ¡echno.", "Granule? No tak jo. Nox mÃ¡ velkÃ½ hlad, a i obyÄejnÃ© granule mu pÅ™ijdou k chuti.", "Hele, pÃ¡nÃ­Äku, nebylo by nÄ›co jinÃ©ho? Ne? Tak ne. Nox se pustil do jÃ­dla. Ne protoÅ¾e by mu to chutnalo, ale proto, Å¾e je hladovÃ½."],
                    mid: ["Granule, no tak jo. KdyÅ¾ jinak nedÃ¡Å¡. Nox se s pÅ™emÃ¡hÃ¡nÃ­m pustil do jÃ­dla, ale nadÅ¡enÃ½ z toho nenÃ­.", "Ach jo, vÃ¡Å¾nÄ›, granule? No tak jo. Nox se s nechutÃ­ pustil do jÃ­dla. SpoÅ™Ã¡dal je jen proto, Å¾e je hladovÃ½.", "JÃ¡ tak nesnÃ¡Å¡Ã­m granule. VÅ¾dycky po nich pÅ¡oukÃ¡m. Nox se s pÅ™emÃ¡hÃ¡nÃ­m pouÅ¡tÃ­ do jÃ­dla."],
                    high: ["Tak tohle teda ne! Tohle jÃ­st nebudu. Nox se znechucenÄ› odvrÃ¡til od nevÃ¡bnÃ½ch granulÃ­, a odeÅ¡el.", "NÃ©! Co Å¾e? Tohle fakt, ale fakt jÃ­st nebudu. Nox se odvrÃ¡til a odchÃ¡zÃ­ od jÃ­dla.", "Ale fuj, to si jez sÃ¡m. Nox pÅ™iÅ¡el k misce, a vÅ¡Ã­ silou jÃ­ packou poslal pryÄ. Miska narazila do zdi, a granule se vysypali."]
                }
            },
            {
                name: "TÄ›stoviny se sÃ½rem a kuÅ™ecÃ­m",
                effects: {
                    hunger: 40, energy: 5, hygiene: -5, fun: 15, satisfaction: 20, weight: 0.3
                },
                taskReward: 25,
                messages: {
                    low: ["MÅˆÃ¡m! Tohle je fakt lahÅ¯dka. Nox se pouÅ¡tÃ­ do jÃ­dla s takovou chutÃ­, Å¾e ho mÃ¡lem spoÅ™Ã¡dal i s miskou.", "TÄ›stovinky! To je pecka! Nox bÄ›Å¾Ã­ k misce s obrovskÃ½m nadÅ¡enÃ­m. JeÅ¡tÄ› neÅ¾ pÅ™ed myskou zabrzdil, tak do nÃ­ vrazil ÄumÃ¡k, a zaÄal hltat.", "To je dobrota. To je takovÃ¡ dobrota. Tohle chci ÄastÄ›ji. Nox bÄ›hem mrknutÃ­ oka jÃ­dlo spoÅ™Ã¡dal, a pak zaÄal mÃ¡lem jÃ­st i misku."],
                    mid: ["Dneska mÃ¡ nÄ›kdo narozeniny? Nox se s lÃ¡skou pustil do jÃ­dla, a vychutnÃ¡vÃ¡ kaÅ¾dÃ© sousto.", "JÃ³! Tohle je mÅˆamka. Nox se s chutÃ­ pouÅ¡tÃ­ do jÃ­dla, a bÄ›hem chvilky ho mÃ¡ v sobÄ›. Pak si odÅ™Ã­hne, zavrtÃ­ se, a koukne na tebe."],
                    high: ["Tohle miluju! Nox si jÃ­dlo tak vychutnÃ¡vÃ¡, Å¾e blahem vrnÃ­.", "Ty jo, tÄ›stoviny. To je lahoda. Je vidÄ›t, jak se nox s jÃ­dlem vyslovenÄ› mazlÃ­. ÄŒumÃ¡k mÃ¡ celÃ½ od omÃ¡Äky, a nÄ›co se mu dostalo i do srsti. BudeÅ¡ ho muset vykoupat.", "KdyÅ¾ dÃ¡vÃ¡Å¡ Noxovy jÃ­dlo, tak ti nejprve skoÄÃ­ do nÃ¡ruÄe. Jeho vdÄ›Änost je vÃ­c neÅ¡ zÅ™ejmÃ¡. Nox v mÅ¾iku jÃ­dlo spoÅ™Ã¡dÃ¡. Ten jeho pohled je k nezaplacenÃ­."]
                }
            },
            {
                name: "VepÅ™ovÃ¡ kotleta",
                effects: {
                    hunger: 50, energy: 10, hygiene: -10, fun: 20, satisfaction: 25, weight: 0.4
                },
                taskReward: 25,
                messages: {
                    low: ["Kotletko moje milovanÃ¡. Tolik se na tebe tÄ›Å¡Ã­m. Nox jÃ­ nejprve opatrnÄ› olÃ­zl, ale pak jÃ­ rychle spoÅ™Ã¡dal.", "Kotleta? No teda pÃ¡nÃ­Äku. Ty jsi ÃºÅ¾asnej. Nox se s chutÃ­ pouÅ¡tÃ­ do hltÃ¡nÃ­ kotlety.", "Kotleta kotletka, seÅ¾eru jÃ­ hnedka. Nox se s obrovskou chutÃ­ pouÅ¡tÃ­ do jÃ­dla. MÃ¡ takovÃ½ hlad, Å¾e mu hed dÃ¡vÃ¡Å¡ druhou."],
                    mid: ["No, tak tohle jsme na Noxoru nemÄ›li. Kotletu prostÄ› miluji. Ani nemrkneÅ¡, a nox mÃ¡ kotletu v sobÄ›.", "TakovÃ¡ lahÅ¯dka. NechtÄ›l sis jÃ­ dÃ¡t ty sÃ¡m pÃ¡nÃ­Äku? Ne? Ty jsi ale ÃºÅ¾asnej. Nox se s chutÃ­ pouÅ¡tÃ­ do jÃ­dla.", "Jestli se pÃ¡nÃ­Äku nepletu, tak cÃ­tÃ­m lahodnou vepÅ™ovou kotletu. Nox jÃ­ zhltne bÄ›hem vteÅ™iny."],
                    high: ["Nox Å¡Å¥astnÄ› zavrnÃ­, bÅ™Ã­Å¡ko si kotletou naplnÃ­. Nox mÃ¡ kotletu moc rÃ¡d.", "Ty jo, to byl ale luxus. NemÃ¡Å¡ tam jeÅ¡tÄ› jednu? Pozor! DalÅ¡Ã­ uÅ¾ mu nedÃ¡vej, jinak se ti tu pozvracÃ­.", "Tak, NoxÃ­ku. Dnes si dÃ¡me oba to samÃ©. Nox oÄichÃ¡ tvÅ¯j talÃ­Å™. Potom zjistÃ­, Å¾e mÃ¡ to samÃ© v misce, a s chutÃ­ se pouÅ¡tÃ­ do jÃ­dla."]
                }
            },
            {
                name: "SyrovÃ© maso",
                effects: {
                    hunger: 35, energy: 15, hygiene: -5, fun: -10, satisfaction: -5, weight: 0.2
                },
                taskReward: 25,
                messages: {
                    low: ["SyrovÃ© masÃ­Äko, pak zesÃ­lÃ­m maliÄko. Nox sice syrovÃ© maso moc nemusÃ­, ale mÃ¡ po nÄ›m krÃ¡snou srst, a vÄ›tÅ¡Ã­ sÃ­lu.", "SyrovÃ© maso? No ale mÅˆam, ty krÃ¡so. Nox se hltavÄ› pouÅ¡tÃ­ do jÃ­dla. Dej pozor Noxi, abys tam nenaÅ¡el pÅ™ehlÃ©dnutou kost.", "Nox mÃ¡ takovÃ½ hlad, Å¾e spoÅ™Ã¡dÃ¡ jÃ­dlo bÄ›hem sekundy. Pozor! SyrovÃ© maso je dobrÃ© na sÃ­lu a srst, ale v nadmÄ›rnÃ©m mnoÅ¾stvÃ­ mÅ¯Å¾e dojÃ­t u noxe k otravÄ›."],
                    mid: ["Nox se tÄ›Å¡Ã­ na nÄ›co dobrÃ©ho. KdyÅ¾ pÅ™ijde k misce, tak zjistÃ­, Å¾e tam mÃ¡ jen syrovÃ© maso. NenÃ­ moc nadÅ¡enÃ½, ale snÃ­ ho.", "Nox mÃ¡ takovÃ½ hlad, Å¾e mu syrovÃ© maso chutnÃ¡. Jak se Å™Ã­kÃ¡, hlad je nejlepÅ¡Ã­ kuchaÅ™.", "A co ty pÃ¡nÃ­Äku? Ty by sis nedal syrovÃ© maso? Ne? No vidÃ­Å¡, a jÃ¡ ho mÃ¡m jÃ­st? Nox se bez nadÅ¡enÃ­ pouÅ¡tÃ­ do jÃ­dla."],
                    high: ["PÃ¡nÃ­Äku to si dÄ›lÃ¡Å¡ srandu? PromiÅˆ, ale tohle jÃ­st nebudu. Jo, kdyÅ¾ mÃ¡ nox fakt hlad, tak i syrovÃ© maso pozÅ™e. JenÅ¾e teÄ mÃ¡ jen malÃ½ hlad, a tak si vybÃ­rÃ¡.", "Ech, syrovÃ© maso? NechceÅ¡ ho hodit na pÃ¡nev, a nÄ›co z nÄ›ho uklohnit? Takhle to jÃ­st nebudu.", "PÃ¡nÃ­Äku promiÅˆ, ale tohle si jez sÃ¡m. JÃ¡ na to nemÃ¡m Å¾aludek."]
                }
            },
            {
                name: "VaÅ™enÃ¡ zelenina",
                effects: {
                    hunger: 10, energy: 0, hygiene: 0, fun: -20, satisfaction: -30, weight: -0.5
                },
                taskReward: 5,
                messages: {
                    low: ["VaÅ™enÃ¡ zelenina je hnus pÃ¡nÃ­Äku. VÃ­Å¡ to? Nakonec jÃ­ nox snÃ­, protoÅ¾e umÃ­rÃ¡ hlady.", "VaÅ™enÃ¡ zelenina? To si snad dÄ›lÃ¡Å¡ srandu. JÃ¡ jÃ­ snÃ­m, protoÅ¾e hlady Å¡ilhÃ¡m. Nox zeleninu snÄ›dl, ale nÃ¡lada mu prudce poklesla.", "Ach ne! UdÄ›lal jsem nÄ›co Å¡patnÃ©ho? Nox fakt nesnÃ¡Å¡Ã­ vaÅ™enou zeleninu. TeÄ mÃ¡ ale brutÃ¡lnÃ­ hlad, a tak jÃ­ snÃ­."],
                    mid: ["Ale fuj! Co to mÃ¡m v misce? VypadÃ¡ to, jako kdyby to pÅ™ede mnou uÅ¾ nÄ›kdo jedl. Nox jÃ­dlo snÃ­, ale radost z toho nemÃ¡.", "Ty tohle jÃ­Å¡ pÃ¡nÃ­Äku? Jo? No tak to tÄ› lituji. Nox s odporem jÃ­dlo spoÅ™Ã¡dÃ¡.", "JÃ¡ tak nesnÃ¡Å¡Ã­m vaÅ™enou zeleninu. UÅ¾ jsi nÄ›kdy vidÄ›l psa, jak jÃ­ zeleninu? JÃ¡ sice pes nejsem, ale jsem mu dost podobnÃ½. Nox jÃ­dlo snÃ­, ale fakt mu nechutnÃ¡."],
                    high: ["Tak tohle jÃ­st nebudu. Nox se naÅ¡tvanÄ› odvrÃ¡tÃ­, a jde do pelÃ­Å¡ku.", "Zelenina to je hnus, kdo jÃ­ Å¾ere, nemÃ¡ vkus! JÃ¡ vkus mÃ¡m, a jÃ­st to rozhodnÄ› nebudu.", "Nox se snaÅ¾il zdrhnout v okamÅ¾iku, kdy jsi mu do misky dÃ¡val vaÅ™enou zeleninu. Nakonec se pÅ™emohl a snÄ›dl jÃ­. PÅ™iprav se na Noxovo legendÃ¡rnÃ­, a rozhodnÄ› ne voÅˆavÃ©, pÅ¡oukÃ¡nÃ­. To budeÅ¡ koukat, jak Nox bude pÅ¡oukat."]
                }
            },
            {
                name: "Tatranka",
                effects: {
                    hunger: 15, energy: 5, hygiene: -3, fun: 10, satisfaction: 10, weight: 0.2
                },
                taskReward: 15,
                messages: {
                    low: ["Nox mÃ¡ straÅ¡nÃ½ hlad. NeÅ¾ si uvÄ›domil co jÃ­, tak jÃ­ mÄ›l v sobÄ›.", "Nox mÃ¡ takovÃ½ hlad, Å¾e i tatranka mu pÅ™ijde k duhu.", "Tatranka zmizela v NoxovÃ½ch ÃºtrobÃ¡ch tak rychle, Å¾e sis toho ani nevÅ¡iml."],
                    mid: ["Tatranku miluji. DÃ¡m si jÃ­ jen jednou, slibuji. Nox jÃ­ snÃ­, Å¾e to ani nezaregistrujeÅ¡.", "Tatranka! Tu mÃ¡m straÅ¡nÄ› rÃ¡d. Nox jÃ­ spolkl celou, ani nekousal.", "Nox pÅ™ijde k misce, a koukÃ¡. Tatranka? To se asi pÃ¡nÃ­Äek musel splÃ©st. Nox jÃ­ snÄ›dl okamÅ¾itÄ›."],
                    high: ["A, zÃ¡kuseÄek. To si dÃ¡m lÃ­bit.", "No tedy pÃ¡nÃ­Äku, ty mÄ› rozmazlujeÅ¡. Ale dÃ­ky.", "MÅˆam, tatranka. To je dobrÅ¯tka."]
                }
            },
            {
                name: "KolÃ¡Ä",
                effects: {
                    hunger: 20, energy: 8, hygiene: -8, fun: 15, satisfaction: 20, weight: 0.3
                },
                taskReward: 15,
                messages: {
                    low: ["PÃ¡nÃ­Äku? Dnes mÃ¡ nÄ›kdo narozeniny? Nox se vrhÃ¡ na kolÃ¡Ä, aÅ¾ mu drobky odletujÃ­ od zbÄ›sile pÅ™eÅ¾vykujÃ­cÃ­ch ÄelistÃ­.", "Nox tak moc hltÃ¡, aÅ¾ se z toho zadÃ½chal. Hlad je prostÄ› hlad.", "Nox trpÃ­ hlady, a kolÃ¡Ä mu dodÃ¡ energiy. Moc by ho ale jÃ­st nemÄ›l."],
                    mid: ["Nox se pokusÃ­ kolÃ¡Ä snÃ­st najednou, jen Å¾e mu to nejde. Nakonec se rozhodne, Å¾e ho snÃ­ normÃ¡lnÄ›. Koukejme jak mu chutnÃ¡.", "Nox tak straÅ¡nÄ› hltÃ¡, aÅ¾ se z toho zakuckÃ¡, a musÃ­ na chvilku pÅ™estat. Jo chlapÄe, tvarohovÃ½ kolÃ¡Ä se musÃ­ jÃ­st pomalu, aby ti nezaskoÄil.", "No tedy pÃ¡nÃ­Äku. KolÃ¡Ä? Tak to je lahoda. Nox se s velkou chutÃ­ pouÅ¡tÃ­ do jÃ­dla."],
                    high: ["KolÃ¡Äek si s chutÃ­ dÃ¡m, rÃ¡no pÄ›knÃ© bobky mÃ¡m. Nox si vychutnÃ¡vÃ¡ kaÅ¾dÃ© sousto.", "To bych byl ale hlupÃ¡Äek, abych si nedal kolÃ¡Äek. Nox se s nÃ­m nejprve laskÃ¡, ale pak ho zhltne. Pozor! NOx mÃ¡ drobky i na srsti. BudeÅ¡ ho muset vykoupat.", "No pÃ¡ni. To jsem musel bÃ½t obzvlÃ¡Å¡Å¥ hodnÃ½, Å¾e my pÃ¡nÃ­Äek dal kolÃ¡Ä."]
                }
            },
            {
                name: "Kobliha",
                effects: {
                    hunger: 10, energy: 3, hygiene: -15, fun: 5, satisfaction: 5, weight: 0.2
                },
                taskReward: 15,
                messages: {
                    low: ["VÃ¡Å¾nÄ›? Nox ti tu umÃ­rÃ¡ hlady, a ty mu dÃ¡Å¡ koblihu. No uÅ¾ je pozdÄ›. Nox jÃ­ celou zhltl, ale marmelÃ¡du mÃ¡ aÅ¾ na hlavÄ›.", "Kobliha vÃ¡Å¾nÄ› nenÃ­ dobrÃ¡ pro noxe. VÃ¡Å¾nÄ› mu jÃ­ chceÅ¡ dÃ¡t? A, uÅ¾ je pozdÄ›. No podÃ­vej se na toho ÄunÃ­ka. MarmelÃ¡du mÃ¡ aÅ¾ za uÅ¡ima.", "Noxi ty jsi ale ÄunÄ›! PodÃ­vej se, jak vypadÃ¡Å¡. Proboha kam aÅ¾ se ti ta marmelÃ¡da dostala?"],
                    mid: ["Tohle nenÃ­ dobrÃ½ nÃ¡pad. Tohle fakt nenÃ­ dobrÃ½ nÃ¡pad. Nox zhltl koblihu, ale je celÃ½ Å¡pinavÃ½.", "Ty jsi se musel asi zblÃ¡znit. PodÃ­vej na Noxe, jak je celÃ½ od marmelÃ¡dy. MÅ¯Å¾e si Å™Ã­kat marmelÃ¡dovÃ½ Joe. Å mahem ho bÄ›Å¾ vykoupat!", "Tak tohle je neÅ¡Å¥astnÃ©. Nox koblihu zhltl, ale nÃ¡plÅˆ se mu dostala na packy. TeÄ tu chodÃ­, a packama rozmazÃ¡vÃ¡ nÃ¡plÅˆ po zemi. Mazej ho vykoupat, a rychle!"],
                    high: ["To jako vÃ¡Å¾nÄ›? No, uÅ¾ je pozdÄ›. Nox skousnul koblihu, ale vÅ¡echno mu vyteklo na packy. Vykoupej ho, aÅ¥ nemÃ¡Å¡ marmelÃ¡du vÅ¡ude.", "Nox prostÄ› neumÃ­ jÃ­st koblihy. UÅ¾ mu je prosÃ­m nedÃ¡vej. Je celÃ½ umazanÃ½. Je ale vidÄ›t, Å¾e je spokojenÃ½."]
                }
            },
            {
                name: "HovÄ›zÃ­ vÃ½var",
                effects: {
                    hunger: 30, energy: 10, hygiene: -5, fun: 10, satisfaction: 15, weight: -0.1
                },
                taskReward: 35,
                messages: {
                    low: ["JÃ³, tak tohle je lahÅ¯dka. Nox mÃ¡ vÃ½var hroznÄ› rÃ¡d. ZvlÃ¡Å¡Å¥, kdyÅ¾ je v nÄ›m hodnÄ› masa.", "VÃ½var pro noxe, je jako kaviÃ¡r pro ÄlovÄ›ka. Nox ho zboÅ¾Åˆuje.", "Nox mÃ¡ tak straÅ¡nÃ½ hlad, Å¾e zaÄne vÃ½var hltat. JenÅ¾e cintÃ¡ vÅ¡ude kolem, a dokonce i na sebe."],
                    mid: ["Nox miluje vÃ½var. Miluje ho tak moc, Å¾e je to aÅ¾ legraÄnÃ­.", "Nox zaboÅ™il ÄumÃ¡k do vÃ½varu, aÅ¾ se kolem rozstÅ™Ã­kl.", "Jo, vÃ½var je fakt dobrota. Nox si ho uÅ¾Ã­vÃ¡. Ach jo, prÃ¡vÄ› do nÄ›j omylem vrazil packou, aÅ¾ se trocha rozstÅ™Ã­kla."],
                    high: ["No pÃ¡ni? KoukÃ¡m pÃ¡nÃ­Äku, Å¾e ses kvÅ¯li me, patlal s vÃ½varem. DÄ›kuji moc.", "VÃ½var? To je blaho. BÅ™icho mÃ¡m jeÅ¡tÄ› troÅ¡ku plnÃ©, ale vÃ½varem nikdy nepohrdnu.", "MÅˆam, to je lahÅ¯Äka."]
                }
            },
            {
                name: "Pivo",
                effects: {
                    hunger: 5, energy: -15, hygiene: -5, fun: 20, satisfaction: -20, weight: 0
                },
                taskReward: 5,
                messages: {
                    low: ["Ty si se musel asi zblÃ¡znit. ProstÅ™edÃ­ z jinÃ©ho svÄ›ta, a ty mu dÃ¡vÃ¡Å¡ pivo? Nox hlady Å¡ilhÃ¡ a jedinÃ© co dostane, je pivo. TleskÃ¡m, fakt super!", "Tak tos pÅ™ehnal! Noxovi pivo zachutnalo, ale je mu po nÄ›m dost zle.", "Nox pÅ™iÅ¡el k misce a koukÃ¡ se, co to v nÃ­ mÃ¡. OchutnÃ¡, Å™Ã­hne si, ale pak to vÅ¡echno vypije. Odnes ho prosÃ­m do pelechu, protoÅ¾e on to sÃ¡m nedokÃ¡Å¾e."],
                    mid: ["PromiÅˆ, jÃ¡ to asi nechÃ¡pu. Tato hra je o tom, Å¾e se starÃ¡Å¡ o mazlÃ­Äka z jinÃ©ho svÄ›ta. A ty mu dÃ¡vÃ¡Å¡ pivo? No, tak teÄ mÃ¡Å¡ problÃ©m. Noxovi je po nÄ›m Å¡patnÄ›.", "JÃ¡ fakt nevÃ­m, co tÃ­m sledujeÅ¡. Ty uÄÃ­Å¡ noxe kalit, aby ti dÄ›lal v baru spoleÄnÃ­ka?", "A koukejme, co to mÃ¡ Nox v misce. Pivo? No, pak po nÄ›m budeÅ¡ muset vytÃ­rat podlahu, protoÅ¾e on ho za chviliÄku vyzvracÃ­."],
                    high: ["PÃ¡nÃ­Äku, ale tohle nenÃ­ pro mÄ›. JÃ¡ pivo nechci. Je my po nÄ›m Å¡patnÄ›, a straÅ¡nÄ› se motÃ¡m.", "No, tak tohle pÃ­t nebudu. Vodu ano, ale tohle ne.", "PÃ¡nÃ­Äku, ale jÃ¡ chci vodu. JÃ¡ mÃ¡m Å¾Ã­zeÅˆ, ale nechci se opÃ­t."]
                }
            }
        ];
        
        const playItems = [
            { name: "Mazlit se", effects: { fun: 20, energy: -5, hunger: -2, satisfaction: 15, weight: -0.1 } },
            { name: "Aportovat", effects: { fun: 30, energy: -20, hunger: -10, satisfaction: 25, weight: -0.5 } },
            { name: "JÃ­t na prochÃ¡zku", effects: { fun: 25, energy: -15, hunger: -8, satisfaction: 20, weight: -0.25 } },
            { name: "JÃ­t si hrÃ¡t ven", effects: { fun: 40, energy: -30, hunger: -15, satisfaction: 30, weight: -0.5 } },
            { name: "LeÅ¾et a poslouchat audioknihu", effects: { fun: 10, energy: 5, hunger: -1, satisfaction: 10, weight: 0.25 } }
        ];

        const noxMessages = {
            bath: [
                "A podÃ­vejme, jak prokouknul. Jsem ÄistÃ½ a voÅˆavÃ½. Ten Å¡ampÃ³n dÄ›lÃ¡ divy!",
                "MÃ¡m velkou radost, Å¾e jsi mÄ› vykoupal. NeÅ¾ jsi mÄ› staÄil utÅ™Ã­t, tak jsem se oklepal, a celÃ©ho tÄ› pocÃ¡kal.",
                "JeÅ¾iÅ¡ to je krÃ¡snÃ½ pocit. Jsem zabalenÃ½ v ruÄnÃ­ku, spokojenÄ› odfrkÃ¡vÃ¡m, a leÅ¾Ã­m ti v nÃ¡ruÄÃ­."
            ],
            sleep: {
                low: ["PodÃ­vej, jak krÃ¡snÄ› spÃ­m, ten nÃ¡Å¡ Å¡mudla.", "SpÃ­m tak nÃ¡dhernÄ›. Nebudeme mÄ› ruÅ¡it, aÅ¥ se nevzbudÃ­m.", "Nejprve jsem spal v pelÃ­Å¡ku, ale pak jsem se pÅ™esunul k tobÄ›. Vzal jsi mÄ› do nÃ¡ruÄe, a tam jsem spokojenÄ› a tvrdÄ› usnul."],
                mid: ["PodÃ­vej se na mÄ›. HojÃ­m si v pelÃ­Å¡ku, a spokojenÄ› odfukuji.", "NechtÄ›l jsem spÃ¡t v pelÃ­Å¡ku, ale u tebe v posteli. LeÅ¾Ã­m u tebe, a poslouchÃ¡m tlukot tvÃ©ho srdce. Jsem Å¡Å¥astnÃ½ a spokojenÃ½.", "Schoulil jsem se do pelÃ­Å¡ku, a spokojenÄ› usnul. Ty jsi mÄ› jeÅ¡tÄ› polaskal, a pak jsi odeÅ¡el."],
                high: ["MÃ¡m nÄ›jakÃ½ Å¾ivÃ½ sen. Hrabej packami, a nÄ›co si v mÃ© Å™eÄi mrmlÃ¡m.", "KrÃ¡tkÃ© zdÅ™Ã­mnutÃ­ jeÅ¡tÄ› nikomu neuÅ¡kodilo. Nejsem moc unavenÃ½, ale rÃ¡d odpoÄÃ­vÃ¡m.", "Na hodinku jsem si schrupnul, ale uÅ¾ jsem zase ÄilÃ½ a hravÃ½."]
            },
            talk: {
                howAreYou: {
                    low: ["JÃ¡ se mÃ¡m moc zle, pÃ¡nÃ­Äku. MÃ¡m hroznÃ½ hlad, jsem pÅ™Ã­Å¡ernÄ› Å¡pinavÃ½ a hroznÄ› unavenÃ½. NecÃ­tÃ­m se moc dobÅ™e.", "Jsem smutnÃ½. BÅ™icho mÃ¡m prÃ¡zdnÃ©, Å¡pÃ­nu mÃ¡m aÅ¾ za uÅ¡ima, a spal bych, aÅ¾ bych breÄel.", "Jsem naÅ¡tvanÃ½. MÃ¡m hlad, jsem Å¡pinavÃ½ a chci spÃ¡t, ale nemÅ¯Å¾u. Vrrrr!"],
                    mid: ["Ani dobÅ™e, ani zle. MÃ¡m dost hlad. TakÃ© se my nelÃ­bÃ­, Å¾e jsem tak Å¡pinavÃ½. Chci spÃ¡t, ale ta neÄistota my vadÃ­.", "Jo pÃ¡nÃ­Äku, mohlo by bÃ½t lÃ©pe. Kdybys my dal najÃ­st, a vykoupal mÄ›. Pak bych byl spokojenÃ½.", "PÃ¡nÃ­Äku, nechceÅ¡ my dÃ¡t najÃ­st? Taky jsem Å¡pinavÃ½, a chci spÃ¡t."],
                    high: ["JÃ¡ se mÃ¡m dobÅ™e. Co ty? Jsem spokojenÃ½ a veselÃ½. CÃ­tÃ­m se ÃºÅ¾asnÄ›!", "Jsem ve skvÄ›lÃ© nÃ¡ladÄ›! DÃ­ky tobÄ› mÃ¡m vÅ¡echno, co potÅ™ebuji.", "MÃ¡m se vÃ½bornÄ›, pÃ¡nÃ­Äku. Å½ivot je krÃ¡snÃ½!"]
                }
            },
            lowStats: "MÃ¡m malÃ½ hlad, jsem unavenÃ½ a Å¡pinavÃ½. MÃ¡m taky mÃ¡lo energie, a uÅ¾ se moc neusmÃ­vÃ¡m. UdÄ›lej se mnou nÄ›co, prosÃ­m. PotÅ™ebuji pomoct.",
            lowSatisfaction: "CÃ­tÃ­m se smutnÃ½. ChceÅ¡ si se mnou promluvit?",
            overweight: "JÃ©je, pÃ¡nÃ­Äku, mÃ¡m nadvÃ¡hu. MÄ›l bych vÃ­ce cviÄit. MÅ¯Å¾eÅ¡ my s tÃ­m prosÃ­m pomoct?",
            underweight: "PÃ¡nÃ­Äku, jsem podvyÅ¾ivenÃ½. PotÅ™ebuji vÃ­ce jÃ­dla, abych zesÃ­lil, a mohl ti pomoct?"
        };

        const shopItems = [
            {
                name: "Å½vÃ½kacÃ­ kost",
                price: 50,
                type: "toy",
                effects: {
                    fun: 25,
                    satisfaction: 15,
                    hygiene: -5
                },
                message: "Noxovi se v oÄÃ­ch rozzÃ¡Å™ily jiskry. Hned se do kosti zakousnul a spokojenÄ› vrnÃ­."
            },
            {
                name: "LuxusnÃ­ pelÃ­Å¡ek",
                price: 200,
                type: "bed",
                effects: {
                    satisfaction: 50,
                    energy: 20,
                    hygiene: 10
                },
                message: "Nox si pelÃ­Å¡ek okamÅ¾itÄ› zamiloval. Schoulil se do nÄ›j a usnul s blaÅ¾enÃ½m ÃºsmÄ›vem na tvÃ¡Å™i."
            },
            {
                name: "ZlatÃ© kapsiÄky",
                price: 75,
                type: "food",
                effects: {
                    hunger: 50,
                    satisfaction: 25,
                    hygiene: -5
                },
                message: "Nox si vychutnÃ¡vÃ¡ kaÅ¾dÃ© sousto. To je pane dobrota!"
            },
            {
                name: "LÃ©ÄivÃ½ lektvar",
                price: 300,
                type: "potion",
                effects: {
                    hunger: 10,
                    energy: 10,
                    hygiene: 10,
                    fun: 10,
                    satisfaction: 10
                },
                message: "Nox se napil lektvaru a vÅ¡echny jeho statistiky se stabilizovaly."
            },
            {
                name: "Noxolit",
                price: 50,
                type: "medicine",
                message: "Po lÃ©ku se cÃ­tÃ­m mnohem lÃ©pe. TeÄ jsem pÅ™ipravenÃ½ na jakoukoliv vÃ½zvu!"
            },
            {
                name: "Noxotronik",
                price: 50,
                type: "medicine",
                message: "Ulevilo se mi. TeÄ uÅ¾ mÄ› z bÅ™Ã­Å¡ka nic nebolÃ­."
            },
            {
                name: "Nomax",
                price: 400,
                type: "potion",
                message: "CelÃ½ jsem se rozzÃ¡Å™il a zÃ¡Å™Ã­ Å¡tÄ›stÃ­m. VÅ¡echny mÃ© potÅ™eby jsou naplnÄ›ny!"
            },
            {
                name: "Noxofit",
                price: 450,
                type: "potion",
                message: "CÃ­tÃ­m se lehÄÃ­ a jsem plnÃ½ energie. Znovu se dostal na svou ideÃ¡lnÃ­ vÃ¡hu!"
            }
        ];
        
        const jobsConfig = {
            "ZÃ¡chranÃ¡Å™": {
                name: "ZÃ¡chranÃ¡Å™",
                duration: 5 * 60, // 5 minut
                reward: 100,
                description: "Nox bude pracovat v horÃ¡ch, kde bude hledat lavinou zavalenÃ© lidi.",
                messages: [
                    "Ty jo, to byla ale Å¡ichta. Dnes jsem zachrÃ¡nil nÄ›kolik lidÃ­.",
                    "Dneska byla ale nuda. Å½Ã¡dnÃ¡ lavina, a tak jsme celÃ½ den jen odpoÄÃ­vali, a chlemtali Äaj.",
                    "Dneska jsem zachrÃ¡nil jednoho turistu co lezl po horÃ¡ch, a pÅ™ecenil svoje sÃ­ly."
                ]
            },
            "HlÃ­daÄ": {
                name: "HlÃ­daÄ",
                duration: 8 * 60, // 8 minut
                reward: 80,
                description: "Nox hlÃ­dÃ¡ pozemek, aby se tam nikdo nevloupal.",
                messages: [
                    "TÃ©da, dneska byla Ã¡le nÅ¯dÃ¡. Nic se nedÄ›lo.",
                    "JÃ¡ jsem tak unavenÃ½. Odchytil jsem tÃ½pka co se chtÄ›l vloupat na pozemek, a tak jsem ho pÄ›knÄ› prohnal.",
                    "NevÃ­Å¡ co se to dneska s lidmi dÄ›je? KaÅ¾dÃ½ se nutnÄ› chtÄ›l dostat na soukromÃ½ pozemek."
                ]
            },
            "OchrÃ¡nce": {
                name: "OchrÃ¡nce",
                duration: 7 * 60, // 7 minut
                reward: 60,
                description: "Nox pomÃ¡hÃ¡ ve mÄ›stÄ›, kde bude pomÃ¡hat dÄ›tem a starÃ½m lidem s pÅ™echÃ¡zenÃ­m pÅ™es ruÅ¡nou silnici.",
                messages: [
                    "Dneska byla legrace. PÅ™evÃ¡dÄ›l jsem dÄ›ti ze Å¡kolky. Jejich uÄitelka my podÄ›kovala za to, jak pÄ›knÄ› pomÃ¡hÃ¡m.",
                    "Dneska jsem pomÃ¡hal jednÃ© starÃ© dÃ¡mÄ›. KdyÅ¾ jsem jÃ­ pÅ™evedl, tak mÄ› pohladila, a dala my kolÃ¡Äek.",
                    "Dneska jsem pomÃ¡hal jednomu nevidomÃ©mu, a byla s nÃ­m sranda. KdyÅ¾ jsem ho pÅ™evedl, tak se se mnou pÄ›knÄ› pomazlil, a celou dobu se smÃ¡l."
                ]
            },
            "FilmovÃ¡ branÅ¾e": {
                name: "FilmovÃ¡ branÅ¾e",
                duration: 12 * 60, // 12 minut
                reward: 125,
                description: "Nox pracuje u filmu, kde obÄas dostane roli.",
                messages: [
                    "PÃ¡nÃ­Äku, dostal jsem roli! Budu hrÃ¡t ve filmu!",
                    "Dnes jsem dÄ›lal kaskadÃ©ra pro jeden film, ve kterÃ©m hrajÃ­ jen zvÃ­Å™ata. SeznÃ¡mil jsem se z jednou pÄ›knou mickou.",
                    "Dnes jsem mÄ›l na mÃ¡le, pÃ¡nÃ­Äku. DÄ›lal jsem kaskadÃ©ra, a musel skoÄit z jednoho jedoucÃ­ho auta do druhÃ©ho. Bylo to o fous. Na Å¡tÄ›stÃ­ se zÃ¡bÄ›r povedl. ReÅ¾izÃ©r mÄ› pochvÃ¡lil."
                ]
            },
            "Terapeut": {
                name: "Terapeut",
                duration: 15 * 60, // 15 minut
                reward: 150,
                description: "Nox pomÃ¡hÃ¡ dÄ›tem a lidem s postiÅ¾enÃ­m, nebo nÄ›jakÃ½m traumatem.",
                messages: [
                    "PÃ¡nÃ­Äku, ğŸ˜¢ jÃ¡ jsem tak smutnÃ½. Dneska jsem byl u jednÃ© malÃ© holÄiÄky. Pak jsem zjistil, Å¾e mÃ¡ rakovinu, a dlouho uÅ¾ tu nebude. Od nÃ­ jsem odchÃ¡zel straÅ¡nÄ› smutnÃ½.",
                    "Dneska jsem byl u jednoho klouÄka, kterÃ½ se bÃ¡l psÅ¯. LeÅ¾el jsem u nÄ›j, a v tom se to stalo. ZaÄal mÄ› hladit, a zaÄalo se mu to lÃ­bit. DÃ­ky mÄ› uÅ¾ nemÃ¡ strach. KdyÅ¾ jsem odchÃ¡zel, tak slyÅ¡Ã­m. Mami, nepoÅ™Ã­dÃ­me si pejska? To bylo tak krÃ¡snÃ©.",
                    "Dnes jsem pomÃ¡hal v domovÄ› dÃºchodcÅ¯. MÄ›lo to ÃºspÄ›ch, a zÃ­tra mÃ¡m pÅ™ijÃ­t zase. Jsou tam hroznÄ› hodnÃ© babiÄky."
                ]
            }
        };

        // Objekt s aktuÃ¡lnÃ­m stavem hry
        let nox = {
            hunger: 100,
            energy: 100,
            hygiene: 100,
            fun: 100,
            satisfaction: 100,
            weight: 5,
            currency: 100,
            isSick: false,
            isPoisoned: false,
            playCount: 0,
            bathCount: 0,
            lastFood: null,
            sameFoodCount: 0,
            inventory: [],
            currentJob: null,
            isWorking: false,
            workTimer: null,
            workRemaining: 0,
            lastWarning: null
        };

        let gameInterval;
        let autoSaveInterval;

        // === REFERENCE NA HTML PRVKY ===
        const elements = {
            startScreen: document.getElementById('startScreen'),
            showStoryButton: document.getElementById('showStoryButton'),
            startGameButton: document.getElementById('startGameButton'),
            gameStats: document.getElementById('gameStats'),
            petNameDisplay: document.getElementById('petNameDisplay'),
            foodMenu: document.getElementById('foodMenu'),
            foodOptionsContainer: document.getElementById('foodOptions'),
            closeFoodMenuButton: document.getElementById('closeFoodMenuButton'),
            playMenu: document.getElementById('playMenu'),
            playOptionsContainer: document.getElementById('playOptions'),
            closePlayMenuButton: document.getElementById('closePlayMenuButton'),
            shopMenu: document.getElementById('shopMenu'),
            shopItemsContainer: document.getElementById('shopItems'),
            closeShopMenuButton: document.getElementById('closeShopMenuButton'),
            noxStatusElem: document.getElementById('noxStatus'),
            firstAidKitButton: document.getElementById('firstAidKitButton'),
            firstAidKitMenu: document.getElementById('firstAidKitMenu'),
            firstAidKitItemsContainer: document.getElementById('firstAidKitItems'),
            closeFirstAidKitButton: document.getElementById('closeFirstAidKitButton'),
            tasksButton: document.getElementById('tasksButton'),
            tasksMenu: document.getElementById('tasksMenu'),
            tasksMenuContent: document.getElementById('tasksMenuContent'),
            taskButtonsContainer: document.getElementById('taskButtonsContainer'),
            acceptTaskButton: document.getElementById('acceptTaskButton'),
            declineTaskButton: document.getElementById('declineTaskButton'),
            closeTasksMenuButton: document.getElementById('closeTasksMenuButton'),
            jobManagementButton: document.getElementById('jobManagementButton'),
            jobButton: document.getElementById('jobButton'),
            jobManagementMenu: document.getElementById('jobManagementMenu'),
            closeJobManagementMenuButton: document.getElementById('closeJobManagementMenuButton'),
            jobMenu: document.getElementById('jobMenu'),
            closeJobMenuButton: document.getElementById('closeJobMenuButton'),
            jobListContainer: document.getElementById('jobList'),
            currentJobText: document.getElementById('currentJobText'),
            jobDescriptionText: document.getElementById('jobDescriptionText'),
            startJobButton: document.getElementById('startJobButton'),
            hungerStatElem: document.getElementById('hungerStat'),
            energyStatElem: document.getElementById('energyStat'),
            hygieneStatElem: document.getElementById('hygieneStat'),
            funStatElem: document.getElementById('funStat'),
            satisfactionStatElem: document.getElementById('satisfactionStat'),
            weightStatElem: document.getElementById('weightStat'),
            currencyDisplay: document.getElementById('currencyDisplay'),
            shopCurrencyDisplay: document.getElementById('shopCurrencyDisplay'),
            feedButton: document.getElementById('feedButton'),
            batheButton: document.getElementById('batheButton'),
            sleepButton: document.getElementById('sleepButton'),
            playButton: document.getElementById('playButton'),
            talkButton: document.getElementById('talkButton'),
            shopButton: document.getElementById('shopButton'),
            saveGameButton: document.getElementById('saveGameButton'),
            loadGameButton: document.getElementById('loadGameButton'),
            customMessageModal: document.getElementById('customMessageModal'),
            modalMessageTitle: document.getElementById('modalMessageTitle'),
            modalMessage: document.getElementById('modalMessage'),
            modalCancelButton: document.getElementById('modalCancelButton'),
            modalOkButton: document.getElementById('modalOkButton')
        };
        
        // UklÃ¡dÃ¡me si, kterÃ½ prvek byl naposledy zaostÅ™enÃ½, abychom se k nÄ›mu mohli vrÃ¡tit
        let lastFocusedElement = null;

        // === ZVUKOVÃ‰ FUNKCE ===
        function playSound(type) {
            if (Tone.context.state !== 'running') {
                Tone.start();
            }

            switch (type) {
                case 'action': simpleSynth.triggerAttackRelease("C5", "8n"); break;
                case 'warning':
                    simpleSynth.triggerAttackRelease("C3", "16n", Tone.now());
                    simpleSynth.triggerAttackRelease("C2", "16n", Tone.now() + 0.1);
                    break;
                case 'gameOver': polySynth.triggerAttackRelease(["C3", "G2", "Eb2"], "2n"); break;
                case 'happy': simpleSynth.triggerAttackRelease("E5", "8n"); break;
                case 'grumpy': simpleSynth.triggerAttackRelease("C4", "8n"); break;
                case 'eating': simpleSynth.triggerAttackRelease("G4", "16n"); break;
                case 'badFood': simpleSynth.triggerAttackRelease("C3", "8n"); break;
                case 'sleeping': simpleSynth.triggerAttackRelease("A3", "4n"); break;
                case 'playful': simpleSynth.triggerAttackRelease("G5", "8n"); break;
                case 'activity': simpleSynth.triggerAttackRelease("D5", "8n"); break;
                case 'saveLoad': simpleSynth.triggerAttackRelease("C6", "16n"); break;
                case 'jobDone':
                    simpleSynth.triggerAttackRelease("E4", "8n");
                    simpleSynth.triggerAttackRelease("G4", "8n", "+0.1");
                    break;
                default: break;
            }
        }
        
        // === OBSLUHA UI A ZPRÃV ===
        // Funkce pro nastavenÃ­ zamÄ›Å™enÃ­ na prvnÃ­ interaktivnÃ­ prvek v kontejneru
        function focusOnFirstInteractiveElement(container) {
            const firstElement = container.querySelector('button, a, input, [tabindex]:not([tabindex="-1"])');
            if (firstElement) {
                firstElement.focus();
            } else {
                // Pokud nenÃ­ Å¾Ã¡dnÃ½ interaktivnÃ­ prvek, zamÄ›Å™ se na samotnÃ½ kontejner
                container.focus();
            }
        }

        function showCustomModal(message, title = 'ZprÃ¡va', onConfirm = null, showCancel = false) {
            // UloÅ¾Ã­me si prvek, kterÃ½ mÄ›l zamÄ›Å™enÃ­ pÅ™ed otevÅ™enÃ­m modÃ¡lnÃ­ho okna
            lastFocusedElement = document.activeElement;
            elements.modalMessageTitle.textContent = title;
            elements.modalMessage.innerHTML = message;
            elements.customMessageModal.style.display = 'flex';
            
            elements.modalOkButton.textContent = 'OK';
            elements.modalOkButton.onclick = () => {
                closeCustomModal();
                if (onConfirm) onConfirm();
            };
            
            elements.modalCancelButton.style.display = showCancel ? 'inline-block' : 'none';
            elements.modalCancelButton.onclick = closeCustomModal;

            // PÅ™esuneme zamÄ›Å™enÃ­ na modÃ¡lnÃ­ okno a nastavÃ­me ho na skrytÃ© pro odeÄÃ­taÄ, aby ho neÄetl dvakrÃ¡t
            elements.customMessageModal.focus();
            elements.customMessageModal.setAttribute('aria-hidden', 'false');
            document.addEventListener('keydown', handleModalKeyboard);
        }

        function closeCustomModal() {
            elements.customMessageModal.style.display = 'none';
            elements.customMessageModal.setAttribute('aria-hidden', 'true');
            document.removeEventListener('keydown', handleModalKeyboard);
            // VrÃ¡tÃ­me zamÄ›Å™enÃ­ zpÄ›t na prvek, kterÃ½ ho mÄ›l pÅ™ed otevÅ™enÃ­m okna
            if (lastFocusedElement) {
                lastFocusedElement.focus();
            }
        }

        function handleModalKeyboard(event) {
            if (event.key === 'Escape') {
                closeCustomModal();
            }
            // ZajiÅ¡Å¥ujeme, Å¾e se zamÄ›Å™enÃ­ neztratÃ­, kdyÅ¾ stiskneÅ¡ tab
            const focusableElements = elements.customMessageModal.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');
            const firstFocusable = focusableElements[0];
            const lastFocusable = focusableElements[focusableElements.length - 1];
            if (event.key === 'Tab') {
                if (event.shiftKey) { // ZpÄ›tnÃ½ tab
                    if (document.activeElement === firstFocusable) {
                        lastFocusable.focus();
                        event.preventDefault();
                    }
                } else { // NormÃ¡lnÃ­ tab
                    if (document.activeElement === lastFocusable) {
                        firstFocusable.focus();
                        event.preventDefault();
                    }
                }
            }
        }

        function showMessage(message, title = 'Nox Å™Ã­kÃ¡:') {
            showCustomModal(message, title);
        }

        function getRandomMessage(messages) {
            const randomIndex = Math.floor(Math.random() * messages.length);
            return messages[randomIndex];
        }

        // VylepÅ¡enÃ¡ funkce pro pÅ™epÃ­nÃ¡nÃ­ menu
        function toggleMenu(menuToShow, focusElementId = null) {
            const menus = [elements.startScreen, elements.gameStats, elements.foodMenu, elements.playMenu, elements.shopMenu, elements.firstAidKitMenu, elements.jobManagementMenu, elements.jobMenu];
            menus.forEach(menu => {
                if (menu === menuToShow) {
                    menu.classList.remove('hidden');
                    // Po zobrazenÃ­ novÃ©ho menu pÅ™esuneme zamÄ›Å™enÃ­ na prvnÃ­ prvek
                    if (focusElementId) {
                        document.getElementById(focusElementId).focus();
                    } else {
                        focusOnFirstInteractiveElement(menu);
                    }
                } else {
                    menu.classList.add('hidden');
                }
            });
        }
        
        // === HLAVNÃ HERNÃ LOGIKA ===
        function updateStatsDisplay() {
            elements.hungerStatElem.textContent = `${nox.hunger}%`;
            elements.energyStatElem.textContent = `${nox.energy}%`;
            elements.hygieneStatElem.textContent = `${nox.hygiene}%`;
            elements.funStatElem.textContent = `${nox.fun}%`;
            elements.satisfactionStatElem.textContent = `${nox.satisfaction}%`;
            elements.weightStatElem.textContent = `${nox.weight.toFixed(2)} kg`;
            elements.currencyDisplay.textContent = `${nox.currency} KreditÅ¯`;
            if (elements.shopCurrencyDisplay) elements.shopCurrencyDisplay.textContent = `${nox.currency}`;

            elements.hungerStatElem.className = `text-xl font-bold ${nox.hunger < 30 ? 'text-red-600' : (nox.hunger < 60 ? 'text-orange-500' : 'text-green-500')}`;
            elements.energyStatElem.className = `text-xl font-bold ${nox.energy < 30 ? 'text-red-600' : (nox.energy < 60 ? 'text-orange-500' : 'text-green-500')}`;
            elements.hygieneStatElem.className = `text-xl font-bold ${nox.hygiene < 30 ? 'text-red-600' : (nox.hygiene < 60 ? 'text-orange-500' : 'text-blue-500')}`;
            elements.funStatElem.className = `text-xl font-bold ${nox.fun < 30 ? 'text-red-600' : (nox.fun < 60 ? 'text-orange-500' : 'text-yellow-500')}`;
            elements.satisfactionStatElem.className = `text-xl font-bold ${nox.satisfaction < 25 ? 'text-red-600' : (nox.satisfaction < 50 ? 'text-orange-500' : (nox.satisfaction < 75 ? 'text-yellow-600' : 'text-purple-600'))}`;
            
            // NovÃ½ stav pro vÃ¡hu
            elements.weightStatElem.className = `text-xl font-bold ${nox.weight > 10 || nox.weight < 3 ? 'text-red-600' : 'text-gray-700'}`;

            // --- PÅ˜IDANÃ LOGIKA PRO ZOBRAZOVÃNÃ VAROVÃNÃ ---
            let currentWarning = null;
            if (nox.weight > 10) {
                currentWarning = 'overweight';
            } else if (nox.isSick) {
                currentWarning = 'sick';
            } else if (nox.isPoisoned) {
                currentWarning = 'poisoned';
            } else if (nox.weight < 3) {
                currentWarning = 'underweight';
            }

            if (currentWarning && currentWarning !== nox.lastWarning) {
                if (currentWarning === 'overweight') {
                     showCustomModal(noxMessages.overweight, "NadvÃ¡ha!");
                } else if (currentWarning === 'sick') {
                    elements.noxStatusElem.classList.remove('hidden');
                    elements.noxStatusElem.textContent = 'Nox je nemocnÃ½!';
                    elements.noxStatusElem.classList.add('sickness-text');
                    elements.noxStatusElem.classList.remove('poison-text');
                } else if (currentWarning === 'poisoned') {
                    elements.noxStatusElem.classList.remove('hidden');
                    elements.noxStatusElem.textContent = 'Nox mÃ¡ otravu z jÃ­dla!';
                    elements.noxStatusElem.classList.add('poison-text');
                    elements.noxStatusElem.classList.remove('sickness-text');
                } else if (currentWarning === 'underweight') {
                    showCustomModal(noxMessages.underweight, "PodvÃ¡ha!");
                }
                nox.lastWarning = currentWarning;
                playSound('warning');
            } else if (!currentWarning && nox.lastWarning) {
                 elements.noxStatusElem.classList.add('hidden');
                 elements.noxStatusElem.textContent = '';
                 elements.noxStatusElem.classList.remove('sickness-text', 'poison-text');
                 nox.lastWarning = null;
            }
            
            if (nox.isWorking) {
                elements.petNameDisplay.textContent = `${nox.currentJob.name} - zbÃ½vÃ¡ ${Math.floor(nox.workRemaining / 60)} min ${nox.workRemaining % 60} s`;
                disableAllActions();
            } else {
                elements.petNameDisplay.textContent = 'Nox';
                enableAllActions();
            }
        }
        
        function decreaseStats() {
            let decreaseRate = 0.5; // Upraveno, aby statistiky klesaly pomaleji

            if (nox.isSick || nox.isPoisoned) decreaseRate += 0.5;
            if (nox.weight > 10 || nox.weight < 3) decreaseRate += 0.25;

            nox.hunger = Math.max(0, nox.hunger - decreaseRate);
            nox.energy = Math.max(0, nox.energy - decreaseRate);
            nox.hygiene = Math.max(0, nox.hygiene - decreaseRate);
            nox.fun = Math.max(0, nox.fun - decreaseRate);
            nox.satisfaction = Math.max(0, nox.satisfaction - decreaseRate);
            nox.weight = Math.max(1, nox.weight - 0.05);

            updateStatsDisplay();

            if (nox.hunger === 0 || nox.energy === 0 || nox.hygiene === 0 || nox.fun === 0 || nox.satisfaction === 0) {
                endGame();
            } else {
                if (nox.hunger < 20 || nox.energy < 20 || nox.hygiene < 20 || nox.fun < 20) {
                    // showMessage(noxMessages.lowStats);
                    // playSound('warning');
                } else if (nox.satisfaction < 30) {
                    // showMessage(noxMessages.lowSatisfaction);
                    // playSound('grumpy');
                }
            }
        }
        
        function endGame() {
            clearInterval(gameInterval);
            clearInterval(autoSaveInterval);
            showCustomModal(`Ach ne! Nox uÅ¾ nemÃ¡ sÃ­lu. Hra skonÄila. Zkus to znovu!`, 'Konec hry');  
            playSound('gameOver');
            elements.startGameButton.textContent = 'HrÃ¡t znovu!';
            toggleMenu(elements.startScreen);
            
            // ResetovÃ¡nÃ­ stavu hry
            nox = { 
                hunger: 100, 
                energy: 100, 
                hygiene: 100, 
                fun: 100, 
                satisfaction: 100, 
                weight: 5, 
                currency: 100,
                isSick: false,
                isPoisoned: false,
                playCount: 0,
                bathCount: 0,
                lastFood: null,
                sameFoodCount: 0,
                inventory: [],
                currentJob: null,
                isWorking: false,
                workTimer: null,
                workRemaining: 0,
                lastWarning: null
            };
            
            localStorage.removeItem('noxSave');
            updateStatsDisplay();
        }

        function startGame() {
            toggleMenu(elements.gameStats);
            elements.petNameDisplay.textContent = 'Nox';
            showMessage('VÃ­tej. TvÅ¯j Nox je pÅ™ipraven na dobrodruÅ¾stvÃ­.');
            updateStatsDisplay();
            
            if (gameInterval) clearInterval(gameInterval);
            if (autoSaveInterval) clearInterval(autoSaveInterval);

            gameInterval = setInterval(decreaseStats, 60000);
            autoSaveInterval = setInterval(saveGameToLocalStorage, AUTOSAVE_INTERVAL * 1000);
        }

        // === AKCE A INTERAKCE ===
        function applyEffects(effects) {
            if (effects.hunger !== undefined) nox.hunger = Math.min(100, Math.max(0, nox.hunger + effects.hunger));
            if (effects.energy !== undefined) nox.energy = Math.min(100, Math.max(0, nox.energy + effects.energy));
            if (effects.hygiene !== undefined) nox.hygiene = Math.min(100, Math.max(0, nox.hygiene + effects.hygiene));
            if (effects.fun !== undefined) nox.fun = Math.min(100, Math.max(0, nox.fun + effects.fun));
            if (effects.satisfaction !== undefined) nox.satisfaction = Math.min(100, Math.max(0, nox.satisfaction + effects.satisfaction));
            if (effects.weight !== undefined) nox.weight = Math.max(1, nox.weight + effects.weight);
            updateStatsDisplay();
        }
        
        function applyFoodEffects(food) {
            if (nox.lastFood === food.name) {
                nox.sameFoodCount++;
                if (nox.sameFoodCount >= 5) {
                    nox.isPoisoned = true;
                    showCustomModal("Noxovi je zle! OdeÅ¡el od misky a pozvracel se. PotÅ™ebujeÅ¡ lÃ©k Noxotronik z lÃ©kÃ¡rniÄky!", "Nox mÃ¡ otravu!");
                }
            } else {
                nox.sameFoodCount = 1;
                nox.lastFood = food.name;
            }
            
            applyEffects(food.effects);
            updateStatsDisplay();

            let message;
            if (nox.hunger <= 30) {
                message = getRandomMessage(food.messages.low);
            } else if (nox.hunger >= 90) {
                message = getRandomMessage(food.messages.high);
            } else {
                message = getRandomMessage(food.messages.mid);
            }
            showMessage(message);
            
            if (food.name === "VaÅ™enÃ¡ zelenina" || food.name === "Pivo") {
                playSound('badFood');
            } else {
                playSound('eating');
            }
            toggleMenu(elements.gameStats);
        }

        function showFoodMenu() {
            toggleMenu(elements.foodMenu, 'foodMenuTitle');
            elements.foodOptionsContainer.innerHTML = '';

            foodItems.forEach(food => {
                const button = document.createElement('button');
                button.textContent = food.name;
                button.className = 'bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-2 px-4 rounded-xl shadow-sm transition duration-300 ease-in-out transform hover:scale-105';
                button.addEventListener('click', () => {
                    applyFoodEffects(food);
                });
                elements.foodOptionsContainer.appendChild(button);
            });
        }

        function applyPlayEffects(activity) {
            if (activity.name === "JÃ­t si hrÃ¡t ven" || activity.name === "JÃ­t na prochÃ¡zku" || activity.name === "Aportovat") {
                nox.playCount++;
                if (nox.playCount >= 5) {
                    nox.isSick = true;
                    showCustomModal("Nox je nachlazenÃ½! NeustÃ¡lÃ© hranÃ­ venku mu nedÄ›lÃ¡ dobÅ™e. PotÅ™ebujeÅ¡ lÃ©k Noxolit z lÃ©kÃ¡rniÄky!", "Nox je nemocnÃ½!");
                }
            } else {
                nox.playCount = 0;
            }
            
            applyEffects(activity.effects);

            showMessage(activity.message);
            playSound('activity');
            toggleMenu(elements.gameStats);
        }

        function showPlayMenu() {
            toggleMenu(elements.playMenu, 'playMenuTitle');
            elements.playOptionsContainer.innerHTML = '';

            playItems.forEach(activity => {
                const button = document.createElement('button');
                button.textContent = activity.name;
                button.className = 'bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-2 px-4 rounded-xl shadow-sm transition duration-300 ease-in-out transform hover:scale-105';
                button.addEventListener('click', () => {
                    applyPlayEffects(activity);
                });
                elements.playOptionsContainer.appendChild(button);
            });
        }
        
        function batheNox() {
            nox.hygiene = Math.min(100, nox.hygiene + 25);
            nox.fun = Math.min(100, nox.fun + 5);
            nox.satisfaction = Math.min(100, nox.satisfaction + 10);
            updateStatsDisplay();
            showMessage(getRandomMessage(noxMessages.bath));
            playSound('action');
        }

        function sleepNox() {
            let message;
            let soundType = 'action';
            
            if (nox.energy >= 90) {
                message = getRandomMessage(noxMessages.sleep.high);
                nox.satisfaction = Math.max(0, nox.satisfaction - 5);
                soundType = 'grumpy';
            } else if (nox.energy >= 50) {
                message = getRandomMessage(noxMessages.sleep.mid);
                nox.energy = Math.min(100, nox.energy + 30);
                nox.hunger = Math.max(0, nox.hunger - 10);
                nox.satisfaction = Math.min(100, nox.satisfaction + 15);
                soundType = 'sleeping';
            } else {
                message = getRandomMessage(noxMessages.sleep.low);
                nox.energy = Math.min(100, nox.energy + 50);
                nox.hunger = Math.max(0, nox.hunger - 15);
                nox.satisfaction = Math.min(100, nox.satisfaction + 25);
                soundType = 'sleeping';
            }

            updateStatsDisplay();
            showMessage(message);
            playSound(soundType);
        }
        
        function talkToNox() {
            let message;
            const avgStat = (nox.hunger + nox.energy + nox.hygiene) / 3;
            if (avgStat <= 30) {
                message = getRandomMessage(noxMessages.talk.howAreYou.low);
            } else if (avgStat <= 90) {
                message = getRandomMessage(noxMessages.talk.howAreYou.mid);
            } else {
                message = getRandomMessage(noxMessages.talk.howAreYou.high);
            }
            showCustomModal(message, 'Nox odpovÃ­dÃ¡');
        }

        function openShop() {
            toggleMenu(elements.shopMenu, 'shopMenuTitle');
            elements.shopCurrencyDisplay.textContent = `${nox.currency}`;
            renderShopItems();
        }

        function buyItem(item) {
            if (nox.currency >= item.price) {
                nox.currency -= item.price;
                
                if (item.type === "medicine" || item.type === "potion") {
                    nox.inventory.push(item);
                    showMessage(`Koupil jsi ${item.name} za ${item.price} KreditÅ¯ a uloÅ¾il jej do lÃ©kÃ¡rniÄky.`);
                } else {
                    applyEffects(item.effects);
                    showMessage(item.message);
                }
                
                updateStatsDisplay();
                toggleMenu(elements.gameStats);
            } else {
                showCustomModal(`NemÃ¡Å¡ dostatek KreditÅ¯ na nÃ¡kup ${item.name}. PotÅ™ebujeÅ¡ ${item.price} KreditÅ¯, ale mÃ¡Å¡ jen ${nox.currency}.`, "Nedostatek KreditÅ¯");
            }
        }

        function renderShopItems() {
            elements.shopItemsContainer.innerHTML = '';
            
            shopItems.forEach(item => {
                const button = document.createElement('button');
                button.textContent = item.name;
                button.className = 'bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-2 px-4 rounded-xl shadow-sm transition duration-300 ease-in-out transform hover:scale-105';
                button.addEventListener('click', () => {
                    buyItem(item);
                });
                elements.shopItemsContainer.appendChild(button);
            });
        }
        
        function openFirstAidKit() {
            toggleMenu(elements.firstAidKitMenu, 'firstAidKitMenuTitle');
            renderFirstAidKitItems();
        }

        function useItemFromInventory(item, index) {
            switch (item.name) {
                case "Nomax":
                    nox.hunger = 100;
                    nox.energy = 100;
                    nox.hygiene = 100;
                    nox.fun = 100;
                    nox.satisfaction = 100;
                    break;
                case "Noxofit":
                    nox.weight = 5;
                    break;
                case "Noxolit":
                    nox.isSick = false;
                    break;
                case "Noxotronik":
                    nox.isPoisoned = false;
                    break;
            }

            nox.inventory.splice(index, 1);
            updateStatsDisplay();
            showMessage(item.message);
            renderFirstAidKitItems();
            toggleMenu(elements.gameStats);
        }

        function renderFirstAidKitItems() {
            elements.firstAidKitItemsContainer.innerHTML = '';
            if (nox.inventory.length === 0) {
                elements.firstAidKitItemsContainer.innerHTML = '<p class="text-gray-600">LÃ©kÃ¡rniÄka je prÃ¡zdnÃ¡.</p>';
            } else {
                nox.inventory.forEach((item, index) => {
                    const button = document.createElement('button');
                    button.textContent = item.name;
                    button.className = 'bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-2 px-4 rounded-xl shadow-sm transition duration-300 ease-in-out transform hover:scale-105';
                    button.addEventListener('click', () => {
                        useItemFromInventory(item, index);
                    });
                    elements.firstAidKitItemsContainer.appendChild(button);
                });
            }
        }
        
        // === ZAMÄšSTNÃNÃ ===
        function disableAllActions() {
            const buttons = document.querySelectorAll('#gameStats button');
            buttons.forEach(btn => btn.disabled = true);
        }

        function enableAllActions() {
            const buttons = document.querySelectorAll('#gameStats button');
            buttons.forEach(btn => btn.disabled = false);
        }
        
        function openJobManagementMenu() {
            toggleMenu(elements.jobManagementMenu, 'jobManagementTitle');
            renderJobList();
        }
        
        function renderJobList() {
            elements.jobListContainer.innerHTML = '';
            if (nox.currentJob) {
                elements.currentJobText.textContent = `Noxovo aktuÃ¡lnÃ­ zamÄ›stnÃ¡nÃ­: ${nox.currentJob.name}`;
            } else {
                elements.currentJobText.textContent = `Nox je nezamÄ›stnanÃ½.`;
            }
            
            for (const jobName in jobsConfig) {
                const job = jobsConfig[jobName];
                const jobDiv = document.createElement('div');
                jobDiv.classList.add('job-item');
                jobDiv.innerHTML = `
                    <h4>${job.name}</h4>
                    <p>${job.description}</p>
                    <p>TrvÃ¡nÃ­: ${job.duration / 60} minut | Plat: ${job.reward} KreditÅ¯</p>
                    <button class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-xl mt-2" data-job-name="${job.name}">Vybrat</button>
                `;
                elements.jobListContainer.appendChild(jobDiv);
            }
        }
        
        // PÅ™idÃ¡n event listener na kontejner pro delegaci udÃ¡lostÃ­
        elements.jobListContainer.addEventListener('click', (event) => {
            const button = event.target.closest('button');
            if (button && button.dataset.jobName) {
                setJob(button.dataset.jobName);
            }
        });

        function setJob(jobName) {
            nox.currentJob = jobsConfig[jobName];
            showMessage(`Ahoj pÃ¡nÃ­Äku, tak jsem ${nox.currentJob.name}! MÅ¯Å¾eÅ¡ mÄ› poslat do prÃ¡ce.`);
            toggleMenu(elements.gameStats);
            updateJobMenu();
        }

        function openJobMenu() {
            toggleMenu(elements.jobMenu, 'jobMenuTitle');
            updateJobMenu();
        }

        function updateJobMenu() {
            if (nox.currentJob) {
                elements.jobDescriptionText.innerHTML = `${nox.currentJob.name}: ${nox.currentJob.description}<br>TrvÃ¡nÃ­: ${nox.currentJob.duration / 60} minut, OdmÄ›na: ${nox.currentJob.reward} KreditÅ¯.`;
                elements.startJobButton.classList.remove('hidden');
            } else {
                elements.jobDescriptionText.textContent = `Nox je momentÃ¡lnÄ› nezamÄ›stnanÃ½. Vyber mu prÃ¡ci ve SprÃ¡vÄ› zamÄ›stnÃ¡nÃ­.`;
                elements.startJobButton.classList.add('hidden');
            }
        }

        function startJob() {
            if (!nox.currentJob) {
                showCustomModal('Nejprve musÃ­Å¡ Noxovi vybrat zamÄ›stnÃ¡nÃ­!', 'Chyba');
                return;
            }
            nox.isWorking = true;
            nox.workRemaining = nox.currentJob.duration;
            showMessage(`OdeÅ¡el jsem do prÃ¡ce na pozici ${nox.currentJob.name}. Ahoj!`);
            updateStatsDisplay();
            nox.workTimer = setInterval(updateWorkTimer, 1000);
            toggleMenu(elements.gameStats);
        }

        function updateWorkTimer() {
            if (nox.isWorking) {
                nox.workRemaining--;
                updateStatsDisplay();
            }
            if (nox.workRemaining <= 0) {
                clearInterval(nox.workTimer);
                finishJob();
            }
        }

        function finishJob() {
            nox.isWorking = false;
            nox.currency += nox.currentJob.reward;
            nox.energy = Math.max(0, nox.energy - 30);
            nox.hunger = Math.max(0, nox.hunger - 20);
            nox.hygiene = Math.max(0, nox.hygiene - 10);
            nox.fun = Math.min(100, nox.fun + 10);
            nox.satisfaction = Math.min(100, nox.satisfaction + 20);
            
            const jobMessage = getRandomMessage(nox.currentJob.messages);
            
            showCustomModal(`VrÃ¡til jsem se z prÃ¡ce, a pÅ™inesl jsem ti ${nox.currentJob.reward} KreditÅ¯.<br><br>"${jobMessage}"`, 'PrÃ¡ce dokonÄena!');
            playSound('jobDone');
            updateStatsDisplay();
        }

        // === UKLÃDÃNÃ A NAÄŒÃTÃNÃ ===
        function saveGameToLocalStorage() {
            try {
                localStorage.setItem('noxSave', JSON.stringify(nox));
                console.log('Hra uloÅ¾ena do lokÃ¡lnÃ­ho ÃºloÅ¾iÅ¡tÄ›.');
            } catch (e) {
                console.error("Chyba pÅ™i uklÃ¡dÃ¡nÃ­ hry:", e);
            }
        }

        function loadGameFromLocalStorage() {
            try {
                const savedData = localStorage.getItem('noxSave');
                if (savedData) {
                    const loadedNox = JSON.parse(savedData);
                    if (loadedNox) {
                        Object.assign(nox, loadedNox);
                        return true;
                    }
                }
            } catch (e) {
                console.error("Chyba pÅ™i naÄÃ­tÃ¡nÃ­ hry z lokÃ¡lnÃ­ho ÃºloÅ¾iÅ¡tÄ›:", e);
            }
            return false;
        }

        function exportGame() {
            try {
                const noxData = JSON.stringify(nox, null, 2);
                const blob = new Blob([noxData], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'nox_save.json';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                showCustomModal('Hra exportovÃ¡na do souboru nox_save.json!', 'UloÅ¾eno');
                playSound('saveLoad');
            } catch (e) {
                showCustomModal('Chyba pÅ™i exportu hry: ' + e.message, 'Chyba');
                console.error("Chyba pÅ™i exportu hry:", e);
            }
        }

        function importGame() {
            const fileInput = document.createElement('input');
            fileInput.type = 'file';
            fileInput.accept = '.json';
            fileInput.addEventListener('change', (event) => {
                const file = event.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        try {
                            const loadedNox = JSON.parse(e.target.result);
                            if (loadedNox && typeof loadedNox.hunger === 'number' && typeof loadedNox.energy === 'number') {
                                Object.assign(nox, loadedNox);
                                updateStatsDisplay();
                                showCustomModal('Hra naÄtena ÃºspÄ›Å¡nÄ› ze souboru!', 'NaÄteno');
                                playSound('saveLoad');
                                if (gameInterval) clearInterval(gameInterval);
                                if (autoSaveInterval) clearInterval(autoSaveInterval);
                                gameInterval = setInterval(decreaseStats, 60000);
                                autoSaveInterval = setInterval(saveGameToLocalStorage, AUTOSAVE_INTERVAL * 1000);
                                toggleMenu(elements.gameStats);
                            } else {
                                showCustomModal('Chyba: Soubor neobsahuje platnÃ¡ data hry Nox.', 'Chyba');
                                playSound('badFood');
                            }
                        } catch (parseError) {
                            showCustomModal('Chyba pÅ™i ÄtenÃ­ souboru: ' + parseError.message, 'Chyba');
                            console.error("Chyba pÅ™i parsovÃ¡nÃ­ JSON souboru:", parseError);
                            playSound('badFood');
                        }
                    };
                    reader.onerror = (readerError) => {
                        showCustomModal('Chyba pÅ™i ÄtenÃ­ souboru: ' + readerError.message, 'Chyba');
                        console.error("Chyba FileReaderu:", readerError);
                        playSound('badFood');
                    };
                    reader.readAsText(file);
                } else {
                    showCustomModal('Å½Ã¡dnÃ½ soubor nebyl vybrÃ¡n.', 'Chyba');
                }
            });
            fileInput.click();
        }

        // === PÅ˜ÃPRAVA HRY PÅ˜I NAÄŒTENÃ STRÃNKY ===
        function init() {
            const savedGameExists = loadGameFromLocalStorage();
            if (savedGameExists) {
                toggleMenu(elements.gameStats);
                startGame();
            } else {
                toggleMenu(elements.startScreen);
            }
        }

        // === PÅ˜IDÃNÃ EVENT LISTENERÅ® ===
        elements.startGameButton.addEventListener('click', () => {
            // Kontrola, zda existuje uloÅ¾enÃ¡ hra, a dotaz na uÅ¾ivatele
            if (localStorage.getItem('noxSave')) {
                showCustomModal('NaÅ¡lo se uloÅ¾enÃ¡ hra. ChceÅ¡ ji nahrÃ¡t?', 'NaÄÃ­st hru?', () => {
                    loadGameFromLocalStorage();
                    startGame();
                }, true);
            } else {
                startGame();
            }
        });
        elements.feedButton.addEventListener('click', showFoodMenu);
        elements.batheButton.addEventListener('click', batheNox);
        elements.sleepButton.addEventListener('click', sleepNox);
        elements.playButton.addEventListener('click', showPlayMenu);
        elements.talkButton.addEventListener('click', talkToNox);
        elements.shopButton.addEventListener('click', openShop);
        elements.firstAidKitButton.addEventListener('click', openFirstAidKit);
        elements.jobManagementButton.addEventListener('click', openJobManagementMenu);
        elements.jobButton.addEventListener('click', openJobMenu);
        elements.startJobButton.addEventListener('click', startJob);
        elements.saveGameButton.addEventListener('click', exportGame);
        elements.loadGameButton.addEventListener('click', importGame);
        elements.showStoryButton.addEventListener('click', () => {
            showCustomModal(document.getElementById('introScreen').innerHTML, 'PÅ™Ã­bÄ›h Noxe');
        });

        // TlaÄÃ­tka pro zavÃ­rÃ¡nÃ­ menu s pÅ™esunem zamÄ›Å™enÃ­ zpÄ›t na hlavnÃ­ menu
        elements.closeFoodMenuButton.addEventListener('click', () => toggleMenu(elements.gameStats));
        elements.closePlayMenuButton.addEventListener('click', () => toggleMenu(elements.gameStats));
        elements.closeShopMenuButton.addEventListener('click', () => toggleMenu(elements.gameStats));
        elements.closeFirstAidKitButton.addEventListener('click', () => toggleMenu(elements.gameStats));
        elements.closeJobManagementMenuButton.addEventListener('click', () => toggleMenu(elements.gameStats));
        elements.closeJobMenuButton.addEventListener('click', () => toggleMenu(elements.gameStats));
        
        // Funkce pro obnovenÃ­ zamÄ›Å™enÃ­ na startovacÃ­ tlaÄÃ­tko po naÄtenÃ­ strÃ¡nky
        window.addEventListener('load', () => {
            const savedGameExists = loadGameFromLocalStorage();
            if (!savedGameExists) {
                elements.startGameButton.focus();
            } else {
                elements.feedButton.focus(); // ZamÄ›Å™ se na prvnÃ­ hernÃ­ tlaÄÃ­tko
            }
        });
        
        // SpuÅ¡tÄ›nÃ­ inicializaÄnÃ­ funkce po naÄtenÃ­ strÃ¡nky
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>